# TCP传输慢问题分析

--------

[参考文献](https://zhuanlan.zhihu.com/p/80043707)

> 前言

对于网络传输慢问题的处理一直是一个难题，一来可能和配置有关二来可能和网络环境有关，很多时候只是从防火墙这方面去定位网络传输慢的现象着实不容易，下面就这类问题，我整理了一些解决思路，以后各位看官在遇到这样的问题的时候可以参考。

在提出解决方案之前，先简单的介绍一下TCP socket传输情况。我们使用的FTP或者HTTP发起访问的过程中会建立一个（或多个）TCP socket，常说的下载速度实际上更确切的就是指的这个TCP socket的传输速度。

> 基础知识

传输速度和 “数据接收方的接受窗口”《 RWND》 以及 “数据发送方的拥塞窗口”《CWND》有关，传输速率取RWND和CWND中小的那一个。其中：

1、数据接收方的RWND可以直接在wireshark中直接看到，每次回应的ACK报文中就会附带这个WINDOW值，比如：

![image](https://user-images.githubusercontent.com/12690102/180908872-907beb53-2bc0-4ad4-ab83-0083960a71ae.png)

通过滑动窗口机制来控制接收窗口，表示着自己此刻还能接收多少字节的报文。当这个窗口太小，那发送方只能按照这个窗口去发送数据，整体下来传输速率就肯定会低很多。

RWND默认情况下占头部的16个bit，可以通过windows scaling 放大到32个bit。

> 解决方案

一、网络自身质量差导致的大量的重传、丢包导致传输速率上不去

二、CWND的增长过慢导致速度上不去
